<div class="wrapper">
  <div class="col-xs-12 col-sm-12 col-md-12">
    <div class="row height__no-nav">

      <div class="col-xs-12 col-sm-12 col-md-6 flex--vh-center">
          <%= render 'shared/chat' %>
          <!-- <p><%#= @user.email %></p> -->
          <!-- <p><%#= @user.user_name %></p> -->
      </div>

      <div class="col-xs-12 col-sm-12 col-md-6 dashboard--container height--100 background--multiply">
        <div class="row height--50 dashcard">
          <div id="dashcard__counsellor" class="col-md-4 height--100 flex--vh-center">
            <div class="text-center">
              <h5 class="font__color--white">Your Counsellor</h5>
              <%= cl_image_tag @counsellor.photo, crop: :fill %>
              <h4 class="font__color--white"><%= @counsellor.first_name %><br><%= @counsellor.last_name %></h4>
              <a class="font__color--white font__size--tc">Feel like talking to a<br>different counsellor?</a>
            </div>
          </div>

          <div id="dashcard__calendar" class="col-md-8 height--100 flex--vh-center">

            <!-- Insert calendar from appointments/index for testing purposes -->

            <%= stylesheet_link_tag 'calendar', media: 'all' %>

            <!-- In-file styling of the calendar -->
         <!--    <style>
              #calendar {
                font-size: 14px;
                margin-right: -25px;
                /*width: 90%;*/
              }
            </style> -->

            <div class='calendar'></div>

            <!-- <div id="calendar"></div> -->



            <% content_for(:after_js) do %>
              <%= javascript_tag do %>




                var event = {
                  id: 1,
                  title: "test",
                  start: new Date()
                };


                $('#calendar').fullCalendar({
                  height: "parent",
                  defaultView: "month",
                  header: false,
                  weekends: false,
                  selectable: true,


                  select: function(start){
                    alert(start);
                    // var selDate = new Date(start);
                    // add your function
                  },

                  events: [

                    <% @appointments.each do |appointment| %>
                      {
                          <!-- title  : <%= ("Booked").to_json.html_safe %>, -->
                          start  : <%= appointment.start_time.strftime("%Y-%m-%dT%H:%M").to_json.html_safe %>,
                          end    : <%= appointment.end_time.strftime("%Y-%m-%dT%H:%M").to_json.html_safe %>,
                          title    :
                         <!--  Probably don't need, since all bookings should from now on have a URL -->
                          <% if appointment.url %>
                            "Booked with the URL: " + <%= appointment.url.to_json.html_safe %>
                          <% else %>
                            <%= ("Booked").to_json.html_safe %>
                          <% end %>,
                          url    : <%= appointment.url.to_json.html_safe %>

                      },
                    <% end %>
                  ],

                  eventClick: function(event) {
                    if (event.url) {
                        window.open(event.url);
                        return false;
                    }


                  }
                });


                $('#calendar').fullCalendar( 'renderEvent', event, true);


              <% end %>
            <% end %>


            <!--<%#= render 'shared/calendar' %> -->
          </div>
        </div>

        <div class="row height--50 dashcard">
          <div id="dashcard__goals" class="col-md-6 height--100 flex--vh-center">
            <div class="text-center">
              <i class="fa fa-flag fa-5x font__color--white"></i>
              <br>
              <br>
              <p class="font__color--white">Goals</p>
              <p class="font__color--white">[UNDER CONSTRUCTION]</p>
            </div>
          </div>
          <div id="dashcard__mood" class="col-md-6 height--100 flex--vh-center">
            <%= render 'shared/mood_tracker' %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
